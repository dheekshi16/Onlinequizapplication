<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>QuizConnect â€” Create & Join Quiz</title>
<style>
body {
  font-family: 'Poppins', sans-serif;
  margin: 0;
  background: linear-gradient(135deg, #7b2ff7, #f107a3);
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
}
.container {
  width: 90%;
  max-width: 500px;
  background: rgba(255, 255, 255, 0.15);
  padding: 30px;
  border-radius: 15px;
  backdrop-filter: blur(10px);
  text-align: center;
  animation: fadeIn 0.8s ease;
}
button {
  background: #fff;
  color: #7b2ff7;
  border: none;
  padding: 12px 20px;
  margin: 8px;
  border-radius: 8px;
  font-weight: bold;
  cursor: pointer;
  transition: 0.3s;
}
button:hover {
  transform: translateY(-2px);
  background: #f0f0f0;
}
input, select {
  width: 100%;
  padding: 10px;
  border-radius: 8px;
  border: none;
  margin: 5px 0;
  outline: none;
}
.hidden { display: none; }
.result-text {
  font-size: 22px;
  margin: 20px 0;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px);}
  to { opacity: 1; transform: translateY(0);}
}
.progress {
  width: 100%;
  background: rgba(255,255,255,0.2);
  border-radius: 8px;
  margin: 10px 0;
}
.progress-bar {
  height: 10px;
  background: #fff;
  width: 0%;
  border-radius: 8px;
  transition: width 0.3s ease;
}
</style>
</head>

<body>
<div class="container" id="homePage">
  <h1>QuizConnect</h1>
  <p>Create or join quizzes instantly!</p>
  <button onclick="showPage('createPage')">Create Quiz</button>
  <button onclick="showPage('joinPage')">Join Quiz</button>
</div>

<!-- Create Quiz Page -->
<div class="container hidden" id="createPage">
  <h2>Create Your Quiz</h2>
  <input type="text" id="question" placeholder="Enter Question" />
  <input type="text" id="optionA" placeholder="Option A" />
  <input type="text" id="optionB" placeholder="Option B" />
  <input type="text" id="optionC" placeholder="Option C" />
  <input type="text" id="optionD" placeholder="Option D" />
  <select id="correctAnswer">
    <option value="">Select Correct Option</option>
    <option value="A">Option A</option>
    <option value="B">Option B</option>
    <option value="C">Option C</option>
    <option value="D">Option D</option>
  </select>
  <button onclick="addQuestion()">Add Question</button>
  <ul id="previewList" style="text-align:left;"></ul>
  <button onclick="finishQuiz()">Finish & Generate Code</button>
  <p id="quizCodeDisplay"></p>
  <button onclick="showPage('homePage')">Home</button>
</div>

<!-- Join Quiz Page -->
<div class="container hidden" id="joinPage">
  <h2>Join a Quiz</h2>
  <input type="text" id="quizCodeInput" placeholder="Enter Quiz Code (e.g., QZ123)" />
  <button onclick="joinQuiz()">Join Quiz</button>
  <button onclick="showPage('homePage')">Home</button>
</div>

<!-- Quiz Player Page -->
<div class="container hidden" id="quizPage">
  <h2 id="quizQuestion"></h2>
  <div id="optionsContainer"></div>
  <div class="progress"><div class="progress-bar" id="progressBar"></div></div>
  <button id="nextButton" onclick="nextQuestion()">Next</button>
</div>

<!-- Result Page -->
<div class="container hidden" id="resultPage">
  <h2>Results</h2>
  <div class="result-text" id="resultText"></div>
  <button onclick="showPage('homePage')">Go Home</button>
</div>

<script>
let currentQuiz = [];
let currentIndex = 0;
let score = 0;

// Navigation
function showPage(page) {
  document.querySelectorAll('.container').forEach(c => c.classList.add('hidden'));
  document.getElementById(page).classList.remove('hidden');
}

let tempQuiz = [];

function addQuestion() {
  const q = document.getElementById('question').value.trim();
  const a = document.getElementById('optionA').value;
  const b = document.getElementById('optionB').value;
  const c = document.getElementById('optionC').value;
  const d = document.getElementById('optionD').value;
  const ans = document.getElementById('correctAnswer').value;
  if (!q || !a || !b || !c || !d || !ans) {
    alert('Please fill in all fields.');
    return;
  }

  tempQuiz.push({q, options:[a,b,c,d], answer: ans});
  const li = document.createElement('li');
  li.textContent = q + ' [' + ans + ']';
  document.getElementById('previewList').appendChild(li);
  document.querySelectorAll('#createPage input').forEach(inp => inp.value='');
  document.getElementById('correctAnswer').value = '';
}

function finishQuiz() {
  if (tempQuiz.length === 0) return alert('Add at least one question');
  const code = 'QZ' + Math.floor(Math.random() * 900 + 100);
  let quizzes = JSON.parse(localStorage.getItem('quizzes') || '{}');
  quizzes[code] = { questions: tempQuiz };
  localStorage.setItem('quizzes', JSON.stringify(quizzes));
  document.getElementById('quizCodeDisplay').innerHTML = 'Quiz Created! Share this Code: ' + code;
  tempQuiz = [];
  document.getElementById('previewList').innerHTML = '';
}

function joinQuiz() {
  const code = document.getElementById('quizCodeInput').value.trim();
  const quizzes = JSON.parse(localStorage.getItem('quizzes') || '{}');
  if (!quizzes[code]) {
    alert('Quiz not found!');
    return;
  }
  currentQuiz = quizzes[code].questions;
  currentIndex = 0;
  score = 0;
  showPage('quizPage');
  loadQuestion();
}

function loadQuestion() {
  const qObj = currentQuiz[currentIndex];
  document.getElementById('quizQuestion').textContent = qObj.q;
  const optionsDiv = document.getElementById('optionsContainer');
  optionsDiv.innerHTML = '';
  qObj.options.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.textContent = opt;
    btn.onclick = () => selectAnswer(i);
    optionsDiv.appendChild(btn);
  });
  updateProgress();
}

let selectedIndex = null;
function selectAnswer(index) {
  selectedIndex = index;
}

function nextQuestion() {
  if (selectedIndex === null) {
    alert('Select an option before continuing.');
    return;
  }
  const correctLetter = currentQuiz[currentIndex].answer;
  const correctIndex = {A:0,B:1,C:2,D:3}[correctLetter];
  if (selectedIndex === correctIndex) score++;
  selectedIndex = null;
  
  if (currentIndex < currentQuiz.length - 1) {
    currentIndex++;
    loadQuestion();
  } else {
    showResults();
  }
}

function updateProgress() {
  const progress = ((currentIndex + 1) / currentQuiz.length) * 100;
  document.getElementById('progressBar').style.width = progress + '%';
}

function showResults() {
  showPage('resultPage');
  const total = currentQuiz.length;
  const percent = ((score / total) * 100).toFixed(0);
  document.getElementById('resultText').textContent =
      `Total: ${total} | Correct: ${score} | Score: ${percent}%`;
}
</script>
</body>
</html>
